{% extends "layout_base.html" %}
{% block title %}Dep√≥sito {{ deposito.codigo }}{% endblock %}
{% block content %}
  <a href="/">‚Üê Voltar</a>
  <h1>Dep√≥sito {{ deposito.codigo }}</h1>

  <h2>Fornecedores</h2>
  
  <!-- Barra de pesquisa -->
  <div style="margin-bottom: 20px;">
    <input type="text" id="searchInput" placeholder="üîç Buscar fornecedor..." 
           style="width: 100%; max-width: 500px; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;">
  </div>

  {% if fornecedores %}
    <ul class="forn-list" id="fornList">
      {% for f in fornecedores %}
        <li class="forn-item" data-name="{{ f.nome|lower }}">
          <a href="/deposito/{{ deposito.codigo }}/fornecedor/{{ f.nome }}">
            <strong>{{ f.nome }}</strong>
            {% if f.caixas_count > 0 %}
              <span style="color: #666; font-size: 14px;"> ({{ f.caixas_count }} caixa{% if f.caixas_count != 1 %}s{% endif %})</span>
            {% endif %}
          </a>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>Nenhum fornecedor cadastrado.</p>
  {% endif %}
  
  <hr style="margin: 30px 0; border: none; border-top: 2px solid #ddd;">
  
  <h3>Adicionar Novo Fornecedor</h3>
  <form method="post" action="/deposito/{{ deposito.codigo }}/adicionar_fornecedor" style="margin-bottom: 20px;">
    <label>
      Nome do Fornecedor: 
      <input type="text" name="fornecedor" placeholder="Ex: NOVA MARCA" required style="padding: 8px; width: 300px; text-transform: uppercase;">
    </label>
    <button type="submit" style="background: #22c55e; color: white; padding: 8px 16px; font-weight: bold; border: none; border-radius: 6px; cursor: pointer; margin-left: 10px;">
      ‚ûï Adicionar Fornecedor
    </button>
  </form>
  
  <p><a href="/logout">Sair</a></p>

  <script>
    // Filtro de pesquisa em tempo real
    document.getElementById('searchInput').addEventListener('input', function(e) {
      const searchTerm = e.target.value.toLowerCase();
      const items = document.querySelectorAll('.forn-item');
      
      items.forEach(item => {
        const name = item.getAttribute('data-name');
        if (name.includes(searchTerm)) {
          item.style.display = '';
        } else {
          item.style.display = 'none';
        }
      });
    });
  </script>
{% endblock %}